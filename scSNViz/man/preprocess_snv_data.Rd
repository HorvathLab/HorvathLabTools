% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocess_snv_data.R
\name{preprocess_snv_data}
\alias{preprocess_snv_data}
\title{Preprocess scSNViz Data}
\usage{
preprocess_snv_data(
  rds_file = NULL,
  countsmatrix_file = NULL,
  snv_file,
  dimensionality_reduction = "UMAP",
  th_vars = 0,
  th_reads = 0,
  enable_sctype = F,
  tissue_type = NULL,
  color_scale = "YlOrRd",
  generate_statistics = F,
  th_snv_cells = 10,
  output_dir = NULL
)
}
\arguments{
\item{rds_file}{Path to the RDS file containing a Seurat object (required if countsmatrix_file is not provided).}

\item{countsmatrix_file}{Path to the folder containing STARsolo output files (barcodes.tsv.gz, features.tsv.gz, matrix.mtx.gz).}

\item{snv_file}{Path to the SNV file (required).}

\item{dimensionality_reduction}{The dimensionality reduction method (umap, pca, or tsne). Default: umap.}

\item{th_vars}{Threshold for number of sceSNVs for a cell to be displayed.. Default: 0.}

\item{th_reads}{Threshold for number of variant reads (N_VAR) for a locus to be considered sceSNV. Default: 0.}

\item{enable_sctype}{Logical; enable scType analysis for cell types. Default: FALSE.}

\item{tissue_type}{Tissue type for scType. Required if enable_sctype is TRUE.}

\item{color_scale}{Color scale for plots. Options include Blues, Reds, etc. Default: YlOrRd.}

\item{generate_statistics}{Logical; if TRUE, generate SNV significance statistics. Default: FALSE.}

\item{th_snv_cells}{Threshold for maximum percentage of cells that contain an SNV for bad reads. Default: 10}

\item{output_dir}{Directory where the statistics files will be saved if \code{generate_statistics} is TRUE. Default: Current working directory.}
}
\value{
A Seurat object with processed metadata and embeddings, processed SNV data, aggregated SNV data, and a data frame for plotting.
}
\description{
This function preprocesses SNV and Seurat object data, performs dimensionality reduction,
clustering, computes various statistics for visualization, and optionally generates statistics.
}
\examples{
processed_data <- preprocess_snv_data(
  rds_file = "path/to/seurat.rds",
  snv_file = "path/to/snv_file.tsv",
  dimensionality_reduction = "umap",
  th_vars = 1,
  th_reads = 2,
  enable_sctype = T,
  tissue_type = "Immunesystem",
  generate_statistics = T,
  th_snv_cells = 10,
  output_dir = "path/to/output"
)

}
